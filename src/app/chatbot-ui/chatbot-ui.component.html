<div id="chat-bot">
  <div class="card-container">
    <div class="card-header">
      <div class="img-avatar">
        <a target="_blank" href="https://www.instagram.com/bitesoftware/">
          <img src="https://i.ibb.co/8DCckdG0/avatarbiti3-removebg-preview.png"
            style="width: 50px; height: 50px; border-radius: 50%; border: 2px solid #010101;">
        </a>
      </div>
      <h2 class="text-chat">
        Biti Assistant<span class="status-indicator"></span>
      </h2>
      <div class="header-controls">
        <button class="control-btn reset-btn" (click)="resetChat()" title="Reiniciar chat">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
            <path d="M3 3v5h5"/>
          </svg>
        </button>
        <button class="control-btn close-btn" (click)="closeChat()" title="Cerrar chat">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
    </div>
    <div class="card-body">
      <div id="chat-container" class="chat-container">
     

        @for (message of messages; track $index) {

        <p [class.sent]="message.role === 'user'" [class.received]="message.role !== 'user'">
          
          <strong>{{ message.role === 'user' ? 'Yo' : 'Biti' }}:</strong> {{ message.content }}
        </p>

       
        }
        @if (isLoading) {
        
          <div id="wifi-loader">
            <div class="apple-dots">
              <div class="apple-dot"></div>
              <div class="apple-dot"></div>
              <div class="apple-dot"></div>
            </div>
          </div>

        }

      </div>
    </div>
    <div class="message-input">
      <input type="text" id="message-input" class="message-send" placeholder="Escribe un mensaje..."
        (keydown)="handleKeyDown($event)">
      <button (click)="sendMessage($event)" class="button-send">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>
</div>

<div>
  <img id="robot-icon" src="https://i.ibb.co/0yXKKmZs/chat2.png" alt="Robot" (click)="toggleChat()" />
  
</div>